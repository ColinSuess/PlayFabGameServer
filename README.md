# PlayFab Custom Game Server
Out of the Box Game Server for PlayFab.com


#### Dependencies
* StrangeIoC For Unity (included)
* PlayFab Game Server SDK (included)
* PlayFab Supports Building to Windows Platform only for Game Servers 

#### Prerequisites 
* General Understanding of Unity
* Understanding of C#
* Understanding of StrangeIoC ( not required, but a bonus )
* Understanding of Dependancy Injection ( not required, but a bonus )

#### Overview
 This repository contains the source code for a Customizable Game Server made with Unity3D.  It runs in server mode (headless) and it's purpose is to provide server authoritive logic and / or Multiplayer networking functionality that can be uploaded to the PlayFab Game Servers tab.  This is an Out of the Box solution, that is super easy to customize.
 
#### Features
* Accepts and stores configuration params that are passed in to the commandline of the server
* Sets up Unity Networking and waits for incomming connections
* Manages connections and disconnections
* Provides PlayFab Session authroization
* Local Debug Mode

 #### Getting Started Guide

When getting started with this custom game server it is good to know or at least understand what StrangeIoC is all about.  So I advise you to visit http://strangeioc.wordpress.com for more information about this framework.  However, it is not required to know as I'll explain the basics that you need to know to modify the game server.

StrangeIoC has an MVC (ish) style to it.  There are Views, and Controllers.  Controllers are generally called Mediators.  Since this is a game server there won't be any UI to it,  thus the views do not do anything other than provide a binding to the Mediators.  Mediators is where you will do most or all of your logic.

Once you've downloaded the project and opened up the code editor (whether it be Monodevelop or Visual Studio) you'll see some folders and I want to take a moment to review those with you.

* StrangeIoC - This folder contains the current version of StrangeIoC  (which is open source and free)
* PlayFabSDK - This is a special version of our SDK that was generated specifically for use in this project.
* Contexts - StrangeIoC has this notion of Contexts which are like modules for your applications.  I have created a few different contexts that provide additional functionalty for use with PlayFab and Unity Networking.
  * MainGameServerContext - This context is your main context and where you will place your views and mediators.  It is the heart of the application and from the main context all other contexts are loaded in.
  * PlayFabContext - This is a specially generated StrangeIoC context to integrate the PlayFabSDK so that it can be more easily called using the StrangeIoC paradigm.  Pretty much don't touch this unless you really know what your doing.  Furthermore it's autogenerated, so anytime we update the SDK, this gets regenerated and your changes will likely get overwritten when you upgrade.  So if you find the need to modify this, then please submit a pull request for us to evaluate your change.
  * PlayFabServer - This context has one functionality and one only,  it parses the command line arugments sent in from the PlayFab Instance Generator and stores them for use in ServerSettingsData.  Which you can Inject into your mediators and have instant access to it.
  * UnityNetworkingContext - This context sets up a Unity Networking Server and listens on the port that is passed into the PlayFab Server when the instance is generated.  This all happens at startup of the server.  It then stores the NetworkManager & the NetworkClient along with other important information about who is connected to the server.  It stores all its data in UnityNetworkingData object that you also Inject into your mediators.  We will get more into the details of this later.  

##### New Mediator and View
To create a new Mediator you will need to do a few steps. 
* Create a file in MainGameServerContext\Mediators,  edit the file and extend it from the Mediator class. Then override the OnRegister() method.
```
public class NewExampleMediator : Mediator {
    public override void OnRegister()
    {
      
    }
}
```
* You also want to create a View file in the Views folder.  Not much goes into the view unless you want to put meta data that you would like to reference from inside the editor. (handy for debugging *winks*)
```
public class NewExampleView : View
{
    //you don't need this, i was just showing you that you can reference this.
    public float CheckAfterSeconds; 
}
```
* In your mediator you can reference the view by injecting it, like this.
```
public class NewExampleMediator : Mediator {
    [Inject] public NewExampleview View {get; set;}
    public override void OnRegister()
    {
       Debug.Log(View.CheckAfterSeconds);
    }
}

```
* 








